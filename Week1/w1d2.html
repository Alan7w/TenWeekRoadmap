<!DOCTYPE html>
<!-- Calculator -->

<html>
    <head>
        <link rel="stylesheet" href="w1d2.css">
        <script>
            // Dynamic calculator
            const add = (a, b) => a + b
            const subtract = (a, b) => a - b
            const divide = (a, b) => a / b
            const multiply = (a, b) => a * b
            const squareRoot = (a) => Math.sqrt(a)
            const findPercentOfNumbers = (a, b) => (a / 100) * b
            const findPercentOfNumber = (a) => a / 100
            const calculateDouble = (a, b, op) => op(a, b)
            const calculateSingle = (a, op) => op(a)

            function handleInputAndCalculate (input) {
                const inputField = document.getElementById("expressionInput")

                if (input == '=') {
                    // square root calculation
                    if (inputField.value.includes("sqrt")) {
                        const operand = inputField.value.slice(inputField.value.indexOf('(') + 1, inputField.value.indexOf(')'))
                        const result = calculateSingle(parseInt(operand), squareRoot)
                        inputField.value = result

                    // percent of two numbers calculation
                    } else if (inputField.value.includes('%') && inputField.value.length > 2) {
                        const [firstOperand, secondOperand] = inputField.value.split('%').map(Number)
                        const result = calculateDouble(parseInt(firstOperand), parseInt(secondOperand), findPercentOfNumbers)
                        inputField.value = result

                    // percent of single number calculation
                    } else if (inputField.value.includes('%') && inputField.value.length <= 2) {
                        const firstOperand = inputField.value.slice(0, inputField.value.indexOf('%'))
                        const result = calculateSingle(parseInt(firstOperand), findPercentOfNumber)
                        inputField.value = result

                    // division calculation
                    } else if (inputField.value.includes('/')) {
                        const [firstOperand, secondOperand] = inputField.value.split('/').map(Number)
                        const result = calculateDouble(parseInt(firstOperand), parseInt(secondOperand), divide)
                        inputField.value = result

                    // multiplication calculation
                    } else if (inputField.value.includes('x')) {
                        const [firstOperand, secondOperand] = inputField.value.split('x').map(Number)
                        const result = calculateDouble(parseInt(firstOperand), parseInt(secondOperand), multiply)
                        inputField.value = result

                    // addition calculation
                    } else if (inputField.value.includes('+')) {
                        const [firstOperand, secondOperand] = inputField.value.split('+').map(Number)
                        const result = calculateDouble(parseInt(firstOperand), parseInt(secondOperand), add)
                        inputField.value = result

                    // subtraction calculation
                    } else if (inputField.value.includes('-')) {
                        const [firstOperand, secondOperand] = inputField.value.split('-').map(Number)
                        const result = calculateDouble(parseInt(firstOperand), parseInt(secondOperand), subtract)
                        inputField.value = result
                    }
                } else if (input == 'sqrt') {
                    if (inputField.value) {
                        inputField.value = 'sqrt(' + inputField.value + ')'
                    }
                    inputField.focus()
                } else if (input == "*") {
                    inputField.value += "x"
                    inputField.focus()
                } else {
                    inputField.value += input
                    inputField.focus()
                }
            }
            
            function handleNumberInput (number) {
                const inputField = document.getElementById("expressionInput")
                inputField.value += number
                inputField.focus()
            }

            function handleClear () {
                const inputField = document.getElementById("expressionInput")
                inputField.value = ""
                inputField.focus()
            }

            function handleErase () {
                const inputField = document.getElementById("expressionInput")
                inputField.value = inputField.value.slice(0, -1)
                inputField.focus()
            }
        </script>
    </head>
    
    <body class="mainContent">
        <div>
            <input type="text" id="expressionInput" class="inputFieldStyle" onkeydown="if (event.key == 'Enter') handleInputAndCalculate('=')">
            <div class="buttonsStyle">
                <div class="buttonsRowStyle">
                    <button id="sqrtButton" class="sqrtButtonStyle" onclick="handleInputAndCalculate('sqrt')"> âˆš </button>
                    <button id="percentButton" class="percentButtonStyle" onclick="handleInputAndCalculate('%')"> % </button>
                    <button id="clearButton" class="clearButtonStyle" onclick="handleClear()"> C </button>
                    <button id="eraseButton" class="eraseButtonStyle" onclick="handleErase()"> X </button>
                </div>
                <div class="buttonsRowStyle">
                    <button id="sevenButton" class="numberButtonStyle" onclick="handleNumberInput(7)"> 7 </button>
                    <button id="eightButton" class="numberButtonStyle" onclick="handleNumberInput(8)"> 8 </button>
                    <button id="nineButton" class="numberButtonStyle" onclick="handleNumberInput(9)"> 9 </button>
                    <button id="divideButton" class="divideButtonStyle" onclick="handleInputAndCalculate('/')"> / </button>
                </div>
                <div class="buttonsRowStyle">
                    <button id="fourButton" class="numberButtonStyle" onclick="handleNumberInput(4)"> 4 </button>
                    <button id="fiveButton" class="numberButtonStyle" onclick="handleNumberInput(5)"> 5 </button>
                    <button id="sixButton" class="numberButtonStyle" onclick="handleNumberInput(6)"> 6 </button>
                    <button id="multiplyButton" class="multiplyButtonStyle" onclick="handleInputAndCalculate('*')"> * </button>
                </div>
                <div class="buttonsRowStyle">
                    <button id="oneButton" class="numberButtonStyle" onclick="handleNumberInput(1)"> 1 </button>
                    <button id="twoButton" class="numberButtonStyle" onclick="handleNumberInput(2)"> 2 </button>
                    <button id="threeButton" class="numberButtonStyle" onclick="handleNumberInput(3)"> 3 </button>
                    <button id="addButton" class="addButtonStyle" onclick="handleInputAndCalculate('+')"> + </button>
                </div>
                <div class="buttonsRowStyle">
                    <button id="zeroButton" class="numberButtonStyle" onclick="handleNumberInput(0)"> 0 </button>
                    <button id="decimalButton" class="decimalButtonStyle" onclick="handleInputAndCalculate('.')"> . </button>
                    <button id="equalButton" class="equalButtonStyle" onclick="handleInputAndCalculate('=')"> = </button>
                    <button id="subtractButton" class="subtractButtonStyle" onclick="handleInputAndCalculate('-')"> - </button>
            </div>
        </div>
    </body>
</html>